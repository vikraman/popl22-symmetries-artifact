<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Pi.Coxeter.LehmerImmersion</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--without-K</a> <a id="25" class="Pragma">--rewriting</a> <a id="37" class="Symbol">#-}</a>

<a id="42" class="Keyword">module</a> <a id="49" href="Pi.Coxeter.LehmerImmersion.html" class="Module">Pi.Coxeter.LehmerImmersion</a> <a id="76" class="Keyword">where</a>

<a id="83" class="Keyword">open</a> <a id="88" class="Keyword">import</a> <a id="95" href="lib.Base.html" class="Module">lib.Base</a>
<a id="104" class="Keyword">open</a> <a id="109" class="Keyword">import</a> <a id="116" href="lib.types.Nat.html" class="Module">lib.types.Nat</a> <a id="130" class="Keyword">using</a> <a id="136" class="Symbol">(</a><a id="137" href="lib.types.Nat.html#291" class="Primitive Operator">_+_</a><a id="140" class="Symbol">)</a>
<a id="142" class="Keyword">open</a> <a id="147" class="Keyword">import</a> <a id="154" href="lib.types.Sigma.html" class="Module">lib.types.Sigma</a>
<a id="170" class="Keyword">open</a> <a id="175" class="Keyword">import</a> <a id="182" href="lib.NType.html" class="Module">lib.NType</a>
<a id="192" class="Keyword">open</a> <a id="197" class="Keyword">import</a> <a id="204" href="lib.PathGroupoid.html" class="Module">lib.PathGroupoid</a>

<a id="222" class="Keyword">open</a> <a id="227" class="Keyword">import</a> <a id="234" href="Pi.Common.Arithmetic.html" class="Module">Pi.Common.Arithmetic</a>
<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="Pi.Common.ListN.html" class="Module">Pi.Common.ListN</a>
<a id="283" class="Keyword">open</a> <a id="288" class="Keyword">import</a> <a id="295" href="Pi.Common.LList.html" class="Module">Pi.Common.LList</a>
<a id="311" class="Keyword">open</a> <a id="316" class="Keyword">import</a> <a id="323" href="Pi.Common.Extra.html" class="Module">Pi.Common.Extra</a>
<a id="339" class="Keyword">open</a> <a id="344" class="Keyword">import</a> <a id="351" href="Pi.Common.Misc.html" class="Module">Pi.Common.Misc</a>

<a id="367" class="Keyword">open</a> <a id="372" class="Keyword">import</a> <a id="379" href="Pi.Lehmer.Lehmer.html" class="Module">Pi.Lehmer.Lehmer</a> <a id="396" class="Keyword">public</a>

<a id="immersion"></a><a id="404" href="Pi.Coxeter.LehmerImmersion.html#404" class="Function">immersion</a> <a id="414" class="Symbol">:</a> <a id="416" class="Symbol">{</a><a id="417" href="Pi.Coxeter.LehmerImmersion.html#417" class="Bound">n</a> <a id="419" class="Symbol">:</a> <a id="421" href="lib.Base.html#6333" class="Datatype">ℕ</a><a id="422" class="Symbol">}</a> <a id="424" class="Symbol">-&gt;</a> <a id="427" href="Pi.Lehmer.Lehmer.html#251" class="Datatype">Lehmer</a> <a id="434" href="Pi.Coxeter.LehmerImmersion.html#417" class="Bound">n</a> <a id="436" class="Symbol">-&gt;</a> <a id="439" href="Pi.Common.ListN.html#266" class="Datatype">Listℕ</a>
<a id="445" href="Pi.Coxeter.LehmerImmersion.html#404" class="Function">immersion</a> <a id="455" class="Symbol">{</a><a id="456" class="Number">0</a><a id="457" class="Symbol">}</a> <a id="459" href="Pi.Lehmer.Lehmer.html#285" class="InductiveConstructor">CanZ</a> <a id="464" class="Symbol">=</a> <a id="466" href="Pi.Common.ListN.html#288" class="InductiveConstructor">nil</a>
<a id="470" href="Pi.Coxeter.LehmerImmersion.html#404" class="Function">immersion</a> <a id="480" class="Symbol">{</a><a id="481" href="lib.Base.html#6359" class="InductiveConstructor">S</a> <a id="483" href="Pi.Coxeter.LehmerImmersion.html#483" class="Bound">n</a><a id="484" class="Symbol">}</a> <a id="486" class="Symbol">(</a><a id="487" href="Pi.Lehmer.Lehmer.html#303" class="InductiveConstructor">CanS</a> <a id="492" href="Pi.Coxeter.LehmerImmersion.html#492" class="Bound">l</a> <a id="494" class="Symbol">{</a><a id="495" href="Pi.Coxeter.LehmerImmersion.html#495" class="Bound">r</a><a id="496" class="Symbol">}</a> <a id="498" href="Pi.Coxeter.LehmerImmersion.html#498" class="Bound">r≤1+n</a><a id="503" class="Symbol">)</a> <a id="505" class="Symbol">=</a> <a id="507" class="Symbol">(</a><a id="508" href="Pi.Coxeter.LehmerImmersion.html#404" class="Function">immersion</a> <a id="518" href="Pi.Coxeter.LehmerImmersion.html#492" class="Bound">l</a><a id="519" class="Symbol">)</a> <a id="521" href="Pi.Common.ListN.html#343" class="Function Operator">++</a> <a id="524" class="Symbol">(((</a><a id="527" href="lib.Base.html#6359" class="InductiveConstructor">S</a> <a id="529" href="Pi.Coxeter.LehmerImmersion.html#483" class="Bound">n</a><a id="530" class="Symbol">)</a> <a id="532" href="Pi.Common.Arithmetic.html#2124" class="Function Operator">∸</a> <a id="534" href="Pi.Coxeter.LehmerImmersion.html#495" class="Bound">r</a><a id="535" class="Symbol">)</a> <a id="537" href="Pi.Common.ListN.html#826" class="Function Operator">↓</a> <a id="539" href="Pi.Coxeter.LehmerImmersion.html#495" class="Bound">r</a><a id="540" class="Symbol">)</a>

<a id="immersion-&gt;&gt;"></a><a id="543" href="Pi.Coxeter.LehmerImmersion.html#543" class="Function">immersion-&gt;&gt;</a> <a id="556" class="Symbol">:</a> <a id="558" class="Symbol">{</a><a id="559" href="Pi.Coxeter.LehmerImmersion.html#559" class="Bound">n</a> <a id="561" class="Symbol">:</a> <a id="563" href="lib.Base.html#6333" class="Datatype">ℕ</a><a id="564" class="Symbol">}</a> <a id="566" class="Symbol">-&gt;</a> <a id="569" class="Symbol">(</a><a id="570" href="Pi.Coxeter.LehmerImmersion.html#570" class="Bound">cl</a> <a id="573" class="Symbol">:</a> <a id="575" href="Pi.Lehmer.Lehmer.html#251" class="Datatype">Lehmer</a> <a id="582" href="Pi.Coxeter.LehmerImmersion.html#559" class="Bound">n</a><a id="583" class="Symbol">)</a> <a id="585" class="Symbol">-&gt;</a> <a id="588" href="Pi.Coxeter.LehmerImmersion.html#559" class="Bound">n</a> <a id="590" href="Pi.Common.LList.html#395" class="Datatype Operator">&gt;&gt;</a> <a id="593" href="Pi.Coxeter.LehmerImmersion.html#404" class="Function">immersion</a> <a id="603" href="Pi.Coxeter.LehmerImmersion.html#570" class="Bound">cl</a>
<a id="606" href="Pi.Coxeter.LehmerImmersion.html#543" class="Function">immersion-&gt;&gt;</a> <a id="619" class="Symbol">{</a><a id="620" class="DottedPattern Symbol">.</a><a id="621" class="DottedPattern Number">0</a><a id="622" class="Symbol">}</a> <a id="624" href="Pi.Lehmer.Lehmer.html#285" class="InductiveConstructor">CanZ</a> <a id="629" class="Symbol">=</a> <a id="631" href="Pi.Common.LList.html#430" class="InductiveConstructor">nil</a>
<a id="635" href="Pi.Coxeter.LehmerImmersion.html#543" class="Function">immersion-&gt;&gt;</a> <a id="648" class="Symbol">{</a><a id="649" href="lib.Base.html#6359" class="InductiveConstructor">S</a> <a id="651" href="Pi.Coxeter.LehmerImmersion.html#651" class="Bound">n</a><a id="652" class="Symbol">}</a> <a id="654" class="Symbol">(</a><a id="655" href="Pi.Lehmer.Lehmer.html#303" class="InductiveConstructor">CanS</a> <a id="660" class="Symbol">{</a><a id="661" href="Pi.Coxeter.LehmerImmersion.html#651" class="Bound">n</a><a id="662" class="Symbol">}</a> <a id="664" href="Pi.Coxeter.LehmerImmersion.html#664" class="Bound">cl</a> <a id="667" class="Symbol">{</a><a id="668" href="Pi.Coxeter.LehmerImmersion.html#668" class="Bound">r</a><a id="669" class="Symbol">}</a> <a id="671" href="Pi.Coxeter.LehmerImmersion.html#671" class="Bound">rn</a><a id="673" class="Symbol">)</a> <a id="675" class="Symbol">=</a>
  <a id="679" class="Keyword">let</a> <a id="683" href="Pi.Coxeter.LehmerImmersion.html#683" class="Bound">p</a> <a id="685" class="Symbol">=</a> <a id="687" href="Pi.Coxeter.LehmerImmersion.html#543" class="Function">immersion-&gt;&gt;</a> <a id="700" class="Symbol">{</a><a id="701" href="Pi.Coxeter.LehmerImmersion.html#651" class="Bound">n</a><a id="702" class="Symbol">}</a> <a id="704" href="Pi.Coxeter.LehmerImmersion.html#664" class="Bound">cl</a>
  <a id="709" class="Keyword">in</a>  <a id="713" href="Pi.Common.LList.html#783" class="Function">&gt;&gt;-++</a> <a id="719" class="Symbol">(</a><a id="720" href="Pi.Common.LList.html#968" class="Function">&gt;&gt;-S</a> <a id="725" href="Pi.Coxeter.LehmerImmersion.html#683" class="Bound">p</a><a id="726" class="Symbol">)</a> <a id="728" class="Symbol">(</a><a id="729" href="Pi.Common.LList.html#652" class="Function">&gt;&gt;-↓</a> <a id="734" class="Symbol">(</a><a id="735" href="lib.Base.html#6359" class="InductiveConstructor">S</a> <a id="737" href="Pi.Coxeter.LehmerImmersion.html#651" class="Bound">n</a><a id="738" class="Symbol">)</a> <a id="740" class="Symbol">(</a><a id="741" href="lib.Base.html#6359" class="InductiveConstructor">S</a> <a id="743" href="Pi.Coxeter.LehmerImmersion.html#651" class="Bound">n</a> <a id="745" href="Pi.Common.Arithmetic.html#2124" class="Function Operator">∸</a> <a id="747" href="Pi.Coxeter.LehmerImmersion.html#668" class="Bound">r</a><a id="748" class="Symbol">)</a> <a id="750" href="Pi.Coxeter.LehmerImmersion.html#668" class="Bound">r</a> <a id="752" class="Symbol">(</a><a id="753" href="Pi.Common.Arithmetic.html#875" class="Function">≤-reflexive</a> <a id="765" class="Symbol">(</a><a id="766" href="Pi.Common.Arithmetic.html#7705" class="Function">plus-minus</a> <a id="777" href="Pi.Coxeter.LehmerImmersion.html#671" class="Bound">rn</a><a id="779" class="Symbol">)))</a>

<a id="canonical-lift"></a><a id="784" href="Pi.Coxeter.LehmerImmersion.html#784" class="Function">canonical-lift</a> <a id="799" class="Symbol">:</a> <a id="801" class="Symbol">{</a><a id="802" href="Pi.Coxeter.LehmerImmersion.html#802" class="Bound">n</a> <a id="804" class="Symbol">:</a> <a id="806" href="lib.Base.html#6333" class="Datatype">ℕ</a><a id="807" class="Symbol">}</a> <a id="809" class="Symbol">-&gt;</a> <a id="812" class="Symbol">(</a><a id="813" href="Pi.Coxeter.LehmerImmersion.html#813" class="Bound">m</a> <a id="815" class="Symbol">:</a> <a id="817" href="lib.Base.html#6333" class="Datatype">ℕ</a><a id="818" class="Symbol">)</a> <a id="820" class="Symbol">-&gt;</a> <a id="823" class="Symbol">(</a><a id="824" href="Pi.Coxeter.LehmerImmersion.html#802" class="Bound">n</a> <a id="826" href="Pi.Common.Arithmetic.html#250" class="Datatype Operator">≤</a> <a id="828" href="Pi.Coxeter.LehmerImmersion.html#813" class="Bound">m</a><a id="829" class="Symbol">)</a> <a id="831" class="Symbol">-&gt;</a> <a id="834" class="Symbol">(</a><a id="835" href="Pi.Coxeter.LehmerImmersion.html#835" class="Bound">cln</a> <a id="839" class="Symbol">:</a> <a id="841" href="Pi.Lehmer.Lehmer.html#251" class="Datatype">Lehmer</a> <a id="848" href="Pi.Coxeter.LehmerImmersion.html#802" class="Bound">n</a><a id="849" class="Symbol">)</a> <a id="851" class="Symbol">-&gt;</a> <a id="854" href="lib.Base.html#5401" class="Record">Σ</a> <a id="856" class="Symbol">(</a><a id="857" href="Pi.Lehmer.Lehmer.html#251" class="Datatype">Lehmer</a> <a id="864" href="Pi.Coxeter.LehmerImmersion.html#813" class="Bound">m</a><a id="865" class="Symbol">)</a> <a id="867" class="Symbol">(λ</a> <a id="870" href="Pi.Coxeter.LehmerImmersion.html#870" class="Bound">clm</a> <a id="874" class="Symbol">-&gt;</a> <a id="877" href="Pi.Coxeter.LehmerImmersion.html#404" class="Function">immersion</a> <a id="887" class="Symbol">{</a><a id="888" href="Pi.Coxeter.LehmerImmersion.html#813" class="Bound">m</a><a id="889" class="Symbol">}</a> <a id="891" href="Pi.Coxeter.LehmerImmersion.html#870" class="Bound">clm</a> <a id="895" href="lib.Base.html#1953" class="Datatype Operator">==</a> <a id="898" href="Pi.Coxeter.LehmerImmersion.html#404" class="Function">immersion</a> <a id="908" class="Symbol">{</a><a id="909" href="Pi.Coxeter.LehmerImmersion.html#802" class="Bound">n</a><a id="910" class="Symbol">}</a> <a id="912" href="Pi.Coxeter.LehmerImmersion.html#835" class="Bound">cln</a><a id="915" class="Symbol">)</a>
<a id="917" href="Pi.Coxeter.LehmerImmersion.html#784" class="Function">canonical-lift</a> <a id="932" class="Symbol">{</a><a id="933" href="Pi.Coxeter.LehmerImmersion.html#933" class="Bound">n</a><a id="934" class="Symbol">}</a> <a id="936" href="Pi.Coxeter.LehmerImmersion.html#936" class="Bound">m</a> <a id="938" href="Pi.Coxeter.LehmerImmersion.html#938" class="Bound">p</a> <a id="940" href="Pi.Coxeter.LehmerImmersion.html#940" class="Bound">cln</a> <a id="944" class="Keyword">with</a> <a id="949" href="Pi.Common.Arithmetic.html#9811" class="Function">≤-∃</a> <a id="953" class="Symbol">_</a> <a id="955" class="Symbol">_</a> <a id="957" href="Pi.Coxeter.LehmerImmersion.html#938" class="Bound">p</a>
<a id="959" href="Pi.Coxeter.LehmerImmersion.html#784" class="Function">canonical-lift</a> <a id="974" class="Symbol">{</a><a id="975" class="DottedPattern Symbol">.</a><a id="976" href="Pi.Coxeter.LehmerImmersion.html#979" class="DottedPattern Bound">m</a><a id="977" class="Symbol">}</a> <a id="979" href="Pi.Coxeter.LehmerImmersion.html#979" class="Bound">m</a> <a id="981" href="Pi.Coxeter.LehmerImmersion.html#981" class="Bound">p</a> <a id="983" href="Pi.Coxeter.LehmerImmersion.html#983" class="Bound">cln</a> <a id="987" class="Symbol">|</a> <a id="989" class="Number">0</a> <a id="991" href="lib.Base.html#5477" class="InductiveConstructor Operator">,</a> <a id="993" href="lib.Base.html#2004" class="InductiveConstructor">idp</a> <a id="997" class="Symbol">=</a> <a id="999" href="Pi.Coxeter.LehmerImmersion.html#983" class="Bound">cln</a> <a id="1003" href="lib.Base.html#5477" class="InductiveConstructor Operator">,</a> <a id="1005" href="lib.Base.html#2004" class="InductiveConstructor">idp</a>
<a id="1009" href="Pi.Coxeter.LehmerImmersion.html#784" class="Function">canonical-lift</a> <a id="1024" class="Symbol">{</a><a id="1025" href="Pi.Coxeter.LehmerImmersion.html#1025" class="Bound">n</a><a id="1026" class="Symbol">}</a> <a id="1028" class="DottedPattern Symbol">.(</a><a id="1030" href="lib.Base.html#6359" class="DottedPattern InductiveConstructor">S</a> <a id="1032" class="DottedPattern Symbol">(</a><a id="1033" href="Pi.Coxeter.LehmerImmersion.html#1053" class="DottedPattern Bound">fst</a> <a id="1037" href="lib.types.Nat.html#291" class="DottedPattern Primitive Operator">+</a> <a id="1039" href="Pi.Coxeter.LehmerImmersion.html#1025" class="DottedPattern Bound">n</a><a id="1040" class="DottedPattern Symbol">))</a> <a id="1043" href="Pi.Coxeter.LehmerImmersion.html#1043" class="Bound">p</a> <a id="1045" href="Pi.Coxeter.LehmerImmersion.html#1045" class="Bound">cln</a> <a id="1049" class="Symbol">|</a> <a id="1051" href="lib.Base.html#6359" class="InductiveConstructor">S</a> <a id="1053" href="Pi.Coxeter.LehmerImmersion.html#1053" class="Bound">fst</a> <a id="1057" href="lib.Base.html#5477" class="InductiveConstructor Operator">,</a> <a id="1059" href="lib.Base.html#2004" class="InductiveConstructor">idp</a> <a id="1063" class="Symbol">=</a>
  <a id="1067" class="Keyword">let</a> <a id="1071" href="Pi.Coxeter.LehmerImmersion.html#1071" class="Bound">rec-m</a> <a id="1077" href="lib.Base.html#5477" class="InductiveConstructor Operator">,</a> <a id="1079" href="Pi.Coxeter.LehmerImmersion.html#1079" class="Bound">rec-p</a> <a id="1085" class="Symbol">=</a> <a id="1087" href="Pi.Coxeter.LehmerImmersion.html#784" class="Function">canonical-lift</a> <a id="1102" class="Symbol">{</a><a id="1103" href="Pi.Coxeter.LehmerImmersion.html#1025" class="Bound">n</a><a id="1104" class="Symbol">}</a> <a id="1106" class="Symbol">(</a><a id="1107" href="Pi.Coxeter.LehmerImmersion.html#1053" class="Bound">fst</a> <a id="1111" href="lib.types.Nat.html#291" class="Primitive Operator">+</a> <a id="1113" href="Pi.Coxeter.LehmerImmersion.html#1025" class="Bound">n</a><a id="1114" class="Symbol">)</a> <a id="1116" class="Symbol">(</a><a id="1117" href="Pi.Common.Arithmetic.html#4444" class="Function">≤-up-+</a> <a id="1124" href="Pi.Common.Arithmetic.html#10019" class="Function">rrr</a><a id="1127" class="Symbol">)</a> <a id="1129" href="Pi.Coxeter.LehmerImmersion.html#1045" class="Bound">cln</a>
  <a id="1135" class="Keyword">in</a>  <a id="1139" class="Symbol">(</a><a id="1140" href="Pi.Lehmer.Lehmer.html#303" class="InductiveConstructor">CanS</a> <a id="1145" href="Pi.Coxeter.LehmerImmersion.html#1071" class="Bound">rec-m</a> <a id="1151" href="Pi.Common.Arithmetic.html#280" class="InductiveConstructor">z≤n</a><a id="1154" class="Symbol">)</a> <a id="1156" href="lib.Base.html#5477" class="InductiveConstructor Operator">,</a> <a id="1158" class="Symbol">(</a><a id="1159" href="Pi.Common.Misc.html#816" class="Function">≡-trans</a> <a id="1167" href="Pi.Common.ListN.html#937" class="Function">++-unit</a> <a id="1175" href="Pi.Coxeter.LehmerImmersion.html#1079" class="Bound">rec-p</a><a id="1180" class="Symbol">)</a>

<a id="&gt;&gt;-drop"></a><a id="1183" href="Pi.Coxeter.LehmerImmersion.html#1183" class="Function">&gt;&gt;-drop</a> <a id="1191" class="Symbol">:</a> <a id="1193" class="Symbol">{</a><a id="1194" href="Pi.Coxeter.LehmerImmersion.html#1194" class="Bound">n</a> <a id="1196" class="Symbol">:</a> <a id="1198" href="lib.Base.html#6333" class="Datatype">ℕ</a><a id="1199" class="Symbol">}</a> <a id="1201" class="Symbol">-&gt;</a> <a id="1204" class="Symbol">(</a><a id="1205" href="Pi.Coxeter.LehmerImmersion.html#1205" class="Bound">cl</a> <a id="1208" class="Symbol">:</a> <a id="1210" href="Pi.Lehmer.Lehmer.html#251" class="Datatype">Lehmer</a> <a id="1217" href="Pi.Coxeter.LehmerImmersion.html#1194" class="Bound">n</a><a id="1218" class="Symbol">)</a> <a id="1220" class="Symbol">-&gt;</a> <a id="1223" class="Symbol">(</a><a id="1224" href="Pi.Coxeter.LehmerImmersion.html#1224" class="Bound">m</a> <a id="1226" class="Symbol">:</a> <a id="1228" href="lib.Base.html#6333" class="Datatype">ℕ</a><a id="1229" class="Symbol">)</a> <a id="1231" class="Symbol">-&gt;</a> <a id="1234" class="Symbol">(</a><a id="1235" href="Pi.Coxeter.LehmerImmersion.html#1224" class="Bound">m</a> <a id="1237" href="Pi.Common.LList.html#395" class="Datatype Operator">&gt;&gt;</a> <a id="1240" class="Symbol">(</a><a id="1241" href="Pi.Coxeter.LehmerImmersion.html#404" class="Function">immersion</a> <a id="1251" href="Pi.Coxeter.LehmerImmersion.html#1205" class="Bound">cl</a><a id="1253" class="Symbol">))</a> <a id="1256" class="Symbol">-&gt;</a> <a id="1259" href="lib.Base.html#5401" class="Record">Σ</a> <a id="1261" class="Symbol">(</a><a id="1262" href="Pi.Lehmer.Lehmer.html#251" class="Datatype">Lehmer</a> <a id="1269" href="Pi.Coxeter.LehmerImmersion.html#1224" class="Bound">m</a><a id="1270" class="Symbol">)</a> <a id="1272" class="Symbol">(λ</a> <a id="1275" href="Pi.Coxeter.LehmerImmersion.html#1275" class="Bound">cln</a> <a id="1279" class="Symbol">-&gt;</a> <a id="1282" href="Pi.Coxeter.LehmerImmersion.html#404" class="Function">immersion</a> <a id="1292" href="Pi.Coxeter.LehmerImmersion.html#1275" class="Bound">cln</a> <a id="1296" href="lib.Base.html#1953" class="Datatype Operator">==</a> <a id="1299" href="Pi.Coxeter.LehmerImmersion.html#404" class="Function">immersion</a> <a id="1309" href="Pi.Coxeter.LehmerImmersion.html#1205" class="Bound">cl</a><a id="1311" class="Symbol">)</a>
<a id="1313" href="Pi.Coxeter.LehmerImmersion.html#1183" class="Function">&gt;&gt;-drop</a> <a id="1321" class="Symbol">{</a><a id="1322" href="lib.Base.html#6351" class="InductiveConstructor">O</a><a id="1323" class="Symbol">}</a> <a id="1325" href="Pi.Lehmer.Lehmer.html#285" class="InductiveConstructor">CanZ</a> <a id="1330" href="Pi.Coxeter.LehmerImmersion.html#1330" class="Bound">m</a> <a id="1332" href="Pi.Common.LList.html#430" class="InductiveConstructor">nil</a> <a id="1336" class="Symbol">=</a>  <a id="1339" href="Pi.Coxeter.LehmerImmersion.html#784" class="Function">canonical-lift</a> <a id="1354" href="Pi.Coxeter.LehmerImmersion.html#1330" class="Bound">m</a> <a id="1356" href="Pi.Common.Arithmetic.html#280" class="InductiveConstructor">z≤n</a> <a id="1360" href="Pi.Lehmer.Lehmer.html#285" class="InductiveConstructor">CanZ</a>
<a id="1365" href="Pi.Coxeter.LehmerImmersion.html#1183" class="Function">&gt;&gt;-drop</a> <a id="1373" class="Symbol">{</a><a id="1374" href="lib.Base.html#6359" class="InductiveConstructor">S</a> <a id="1376" href="Pi.Coxeter.LehmerImmersion.html#1376" class="Bound">n</a><a id="1377" class="Symbol">}</a> <a id="1379" class="Symbol">(</a><a id="1380" href="Pi.Lehmer.Lehmer.html#303" class="InductiveConstructor">CanS</a> <a id="1385" href="Pi.Coxeter.LehmerImmersion.html#1385" class="Bound">cl</a> <a id="1388" class="Symbol">{</a><a id="1389" href="lib.Base.html#6351" class="InductiveConstructor">O</a><a id="1390" class="Symbol">}</a> <a id="1392" href="Pi.Coxeter.LehmerImmersion.html#1392" class="Bound">x</a><a id="1393" class="Symbol">)</a> <a id="1395" href="Pi.Coxeter.LehmerImmersion.html#1395" class="Bound">m</a> <a id="1397" href="Pi.Coxeter.LehmerImmersion.html#1397" class="Bound">mcl</a> <a id="1401" class="Symbol">=</a>
  <a id="1405" class="Keyword">let</a> <a id="1409" href="Pi.Coxeter.LehmerImmersion.html#1409" class="Bound">rec-l</a> <a id="1415" href="lib.Base.html#5477" class="InductiveConstructor Operator">,</a> <a id="1417" href="Pi.Coxeter.LehmerImmersion.html#1417" class="Bound">rec-p</a> <a id="1423" class="Symbol">=</a> <a id="1425" href="Pi.Coxeter.LehmerImmersion.html#1183" class="Function">&gt;&gt;-drop</a> <a id="1433" class="Symbol">{</a><a id="1434" href="Pi.Coxeter.LehmerImmersion.html#1376" class="Bound">n</a><a id="1435" class="Symbol">}</a> <a id="1437" href="Pi.Coxeter.LehmerImmersion.html#1385" class="Bound">cl</a> <a id="1440" href="Pi.Coxeter.LehmerImmersion.html#1395" class="Bound">m</a> <a id="1442" class="Symbol">(</a><a id="1443" href="lib.Base.html#4928" class="Function">transport</a> <a id="1453" class="Symbol">(λ</a> <a id="1456" href="Pi.Coxeter.LehmerImmersion.html#1456" class="Bound">e</a> <a id="1458" class="Symbol">→</a> <a id="1460" href="Pi.Coxeter.LehmerImmersion.html#1395" class="Bound">m</a> <a id="1462" href="Pi.Common.LList.html#395" class="Datatype Operator">&gt;&gt;</a> <a id="1465" href="Pi.Coxeter.LehmerImmersion.html#1456" class="Bound">e</a><a id="1466" class="Symbol">)</a> <a id="1468" href="Pi.Common.ListN.html#937" class="Function">++-unit</a> <a id="1476" href="Pi.Coxeter.LehmerImmersion.html#1397" class="Bound">mcl</a><a id="1479" class="Symbol">)</a>
  <a id="1483" class="Keyword">in</a>  <a id="1487" href="Pi.Coxeter.LehmerImmersion.html#1409" class="Bound">rec-l</a> <a id="1493" href="lib.Base.html#5477" class="InductiveConstructor Operator">,</a> <a id="1495" class="Symbol">(</a><a id="1496" href="Pi.Coxeter.LehmerImmersion.html#1417" class="Bound">rec-p</a> <a id="1502" href="lib.Base.html#2620" class="Function Operator">∙</a> <a id="1504" href="lib.PathGroupoid.html#1539" class="Function">!</a> <a id="1506" href="Pi.Common.ListN.html#937" class="Function">++-unit</a><a id="1513" class="Symbol">)</a>
<a id="1515" href="Pi.Coxeter.LehmerImmersion.html#1183" class="Function">&gt;&gt;-drop</a> <a id="1523" class="Symbol">{</a><a id="1524" href="lib.Base.html#6359" class="InductiveConstructor">S</a> <a id="1526" href="Pi.Coxeter.LehmerImmersion.html#1526" class="Bound">n</a><a id="1527" class="Symbol">}</a> <a id="1529" class="Symbol">(</a><a id="1530" href="Pi.Lehmer.Lehmer.html#303" class="InductiveConstructor">CanS</a> <a id="1535" href="Pi.Coxeter.LehmerImmersion.html#1535" class="Bound">cl</a> <a id="1538" class="Symbol">{</a><a id="1539" href="lib.Base.html#6359" class="InductiveConstructor">S</a> <a id="1541" href="Pi.Coxeter.LehmerImmersion.html#1541" class="Bound">r</a><a id="1542" class="Symbol">}</a> <a id="1544" href="Pi.Coxeter.LehmerImmersion.html#1544" class="Bound">x</a><a id="1545" class="Symbol">)</a> <a id="1547" href="lib.Base.html#6351" class="InductiveConstructor">O</a> <a id="1549" href="Pi.Coxeter.LehmerImmersion.html#1549" class="Bound">mcl</a> <a id="1553" class="Symbol">=</a> <a id="1555" href="lib.Base.html#6081" class="Function">⊥-elim</a> <a id="1562" class="Symbol">(</a><a id="1563" href="Pi.Common.Arithmetic.html#1408" class="Function">1+n≰n</a> <a id="1569" class="Symbol">(</a><a id="1570" href="Pi.Common.Arithmetic.html#739" class="Function">≤-trans</a> <a id="1578" class="Symbol">(</a><a id="1579" href="Pi.Common.LList.html#1281" class="Function">&gt;&gt;-implies-&gt;</a> <a id="1592" href="Pi.Coxeter.LehmerImmersion.html#1549" class="Bound">mcl</a> <a id="1596" href="lib.Base.html#2004" class="InductiveConstructor">idp</a><a id="1599" class="Symbol">)</a> <a id="1601" href="Pi.Common.Arithmetic.html#280" class="InductiveConstructor">z≤n</a><a id="1604" class="Symbol">))</a>
<a id="1607" href="Pi.Coxeter.LehmerImmersion.html#1183" class="Function">&gt;&gt;-drop</a> <a id="1615" class="Symbol">{</a><a id="1616" href="lib.Base.html#6359" class="InductiveConstructor">S</a> <a id="1618" href="Pi.Coxeter.LehmerImmersion.html#1618" class="Bound">n</a><a id="1619" class="Symbol">}</a> <a id="1621" class="Symbol">(</a><a id="1622" href="Pi.Lehmer.Lehmer.html#303" class="InductiveConstructor">CanS</a> <a id="1627" href="Pi.Coxeter.LehmerImmersion.html#1627" class="Bound">cl</a> <a id="1630" class="Symbol">{</a><a id="1631" href="lib.Base.html#6359" class="InductiveConstructor">S</a> <a id="1633" href="Pi.Coxeter.LehmerImmersion.html#1633" class="Bound">r</a><a id="1634" class="Symbol">}</a> <a id="1636" href="Pi.Coxeter.LehmerImmersion.html#1636" class="Bound">x</a><a id="1637" class="Symbol">)</a> <a id="1639" class="Symbol">(</a><a id="1640" href="lib.Base.html#6359" class="InductiveConstructor">S</a> <a id="1642" href="Pi.Coxeter.LehmerImmersion.html#1642" class="Bound">m</a><a id="1643" class="Symbol">)</a> <a id="1645" href="Pi.Coxeter.LehmerImmersion.html#1645" class="Bound">mcl</a> <a id="1649" class="Symbol">=</a>
  <a id="1653" class="Keyword">let</a> <a id="1657" href="Pi.Coxeter.LehmerImmersion.html#1657" class="Bound">n&lt;m</a> <a id="1661" class="Symbol">=</a> <a id="1663" href="Pi.Common.LList.html#1281" class="Function">&gt;&gt;-implies-&gt;</a> <a id="1676" href="Pi.Coxeter.LehmerImmersion.html#1645" class="Bound">mcl</a> <a id="1680" href="lib.Base.html#2004" class="InductiveConstructor">idp</a>
  <a id="1686" class="Keyword">in</a>  <a id="1690" href="Pi.Coxeter.LehmerImmersion.html#784" class="Function">canonical-lift</a> <a id="1705" class="Symbol">(</a><a id="1706" href="lib.Base.html#6359" class="InductiveConstructor">S</a> <a id="1708" href="Pi.Coxeter.LehmerImmersion.html#1642" class="Bound">m</a><a id="1709" class="Symbol">)</a> <a id="1711" class="Symbol">(</a><a id="1712" href="Pi.Common.Arithmetic.html#739" class="Function">≤-trans</a> <a id="1720" class="Symbol">(</a><a id="1721" href="Pi.Common.Arithmetic.html#1100" class="Function">≤-up2</a> <a id="1727" class="Symbol">(</a><a id="1728" href="Pi.Common.Arithmetic.html#875" class="Function">≤-reflexive</a> <a id="1740" class="Symbol">(</a><a id="1741" href="lib.PathGroupoid.html#1539" class="Function">!</a> <a id="1743" class="Symbol">(</a><a id="1744" href="Pi.Common.Arithmetic.html#7705" class="Function">plus-minus</a> <a id="1755" class="Symbol">(</a><a id="1756" href="Pi.Common.Arithmetic.html#1278" class="Function">≤-down2</a> <a id="1764" href="Pi.Coxeter.LehmerImmersion.html#1636" class="Bound">x</a><a id="1765" class="Symbol">)))))</a> <a id="1771" href="Pi.Coxeter.LehmerImmersion.html#1657" class="Bound">n&lt;m</a><a id="1774" class="Symbol">)</a> <a id="1776" class="Symbol">(</a><a id="1777" href="Pi.Lehmer.Lehmer.html#303" class="InductiveConstructor">CanS</a> <a id="1782" href="Pi.Coxeter.LehmerImmersion.html#1627" class="Bound">cl</a> <a id="1785" class="Symbol">{</a><a id="1786" href="lib.Base.html#6359" class="InductiveConstructor">S</a> <a id="1788" href="Pi.Coxeter.LehmerImmersion.html#1633" class="Bound">r</a><a id="1789" class="Symbol">}</a> <a id="1791" href="Pi.Coxeter.LehmerImmersion.html#1636" class="Bound">x</a><a id="1792" class="Symbol">)</a>

<a id="1795" class="Comment">-- l0 : Lehmer 0</a>
<a id="1812" class="Comment">-- l0 = CanZ</a>
<a id="1825" class="Comment">-- l1 : Lehmer 1</a>
<a id="1842" class="Comment">-- l1 = CanS {0} CanZ {1} (s≤s z≤n)</a>
<a id="1878" class="Comment">-- l2 : Lehmer 2</a>
<a id="1895" class="Comment">-- l2 = CanS l1 {2} (s≤s (s≤s z≤n))</a>

<a id="1932" class="Comment">-- ll2 : Listℕ</a>
<a id="1947" class="Comment">-- ll2 = immersion {2} l2</a>
</pre></body></html>